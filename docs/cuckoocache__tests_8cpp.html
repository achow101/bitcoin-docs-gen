<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bitcoin Core: src/test/cuckoocache_tests.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bitcoin_logo_doxygen.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bitcoin Core<span id="projectnumber">&#160;22.99.0</span>
   </div>
   <div id="projectbrief">P2P Digital Currency</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_120ed4da3e3217b1e7fc0b4f48568e79.html">test</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">cuckoocache_tests.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="cuckoocache_8h_source.html">cuckoocache.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="random_8h_source.html">random.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sigcache_8h_source.html">script/sigcache.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="setup__common_8h_source.html">test/util/setup_common.h</a>&gt;</code><br />
<code>#include &lt;boost/test/unit_test.hpp&gt;</code><br />
<code>#include &lt;deque&gt;</code><br />
<code>#include &lt;mutex&gt;</code><br />
<code>#include &lt;shared_mutex&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cuckoocache_tests.cpp:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp__incl.svg" width="3387" height="500"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="cuckoocache__tests_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acff99631b1b544d01990adb377ce74a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#acff99631b1b544d01990adb377ce74a8">BOOST_AUTO_TEST_SUITE</a> (cuckoocache_tests)</td></tr>
<tr class="memdesc:acff99631b1b544d01990adb377ce74a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test Suite for <a class="el" href="namespace_cuckoo_cache.html" title="High-performance cache primitives.">CuckooCache</a>.  <a href="cuckoocache__tests_8cpp.html#acff99631b1b544d01990adb377ce74a8">More...</a><br /></td></tr>
<tr class="separator:acff99631b1b544d01990adb377ce74a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a214df47c3c8fef6d59339193f9db46f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a214df47c3c8fef6d59339193f9db46f0">BOOST_AUTO_TEST_CASE</a> (test_cuckoocache_no_fakes)</td></tr>
<tr class="separator:a214df47c3c8fef6d59339193f9db46f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8d08afa024b8416f8df44deb63527b6"><td class="memTemplParams" colspan="2">template&lt;typename Cache &gt; </td></tr>
<tr class="memitem:af8d08afa024b8416f8df44deb63527b6"><td class="memTemplItemLeft" align="right" valign="top">static double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#af8d08afa024b8416f8df44deb63527b6">test_cache</a> (size_t megabytes, double load)</td></tr>
<tr class="memdesc:af8d08afa024b8416f8df44deb63527b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This helper returns the hit rate when megabytes*load worth of entries are inserted into a megabytes sized cache.  <a href="cuckoocache__tests_8cpp.html#af8d08afa024b8416f8df44deb63527b6">More...</a><br /></td></tr>
<tr class="separator:af8d08afa024b8416f8df44deb63527b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa589a224768fce4e01558f10d7dca8e"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#afa589a224768fce4e01558f10d7dca8e">normalize_hit_rate</a> (double hits, double load)</td></tr>
<tr class="memdesc:afa589a224768fce4e01558f10d7dca8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The normalized hit rate for a given load.  <a href="cuckoocache__tests_8cpp.html#afa589a224768fce4e01558f10d7dca8e">More...</a><br /></td></tr>
<tr class="separator:afa589a224768fce4e01558f10d7dca8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299febd68f12d139909825335e09a57b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a299febd68f12d139909825335e09a57b">BOOST_AUTO_TEST_CASE</a> (cuckoocache_hit_rate_ok)</td></tr>
<tr class="memdesc:a299febd68f12d139909825335e09a57b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the hit rate on loads ranging from 0.1 to 1.6.  <a href="cuckoocache__tests_8cpp.html#a299febd68f12d139909825335e09a57b">More...</a><br /></td></tr>
<tr class="separator:a299febd68f12d139909825335e09a57b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d579e17ce4017d37251f85640cb9e3"><td class="memTemplParams" colspan="2">template&lt;typename Cache &gt; </td></tr>
<tr class="memitem:a65d579e17ce4017d37251f85640cb9e3"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a65d579e17ce4017d37251f85640cb9e3">test_cache_erase</a> (size_t megabytes)</td></tr>
<tr class="memdesc:a65d579e17ce4017d37251f85640cb9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This helper checks that erased elements are preferentially inserted onto and that the hit rate of "fresher" keys is reasonable.  <a href="cuckoocache__tests_8cpp.html#a65d579e17ce4017d37251f85640cb9e3">More...</a><br /></td></tr>
<tr class="separator:a65d579e17ce4017d37251f85640cb9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66cf33a4becc3c40557ef3ebbc4049fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a66cf33a4becc3c40557ef3ebbc4049fe">BOOST_AUTO_TEST_CASE</a> (cuckoocache_erase_ok)</td></tr>
<tr class="separator:a66cf33a4becc3c40557ef3ebbc4049fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b2f5314bd1f7813f545f634d82943e"><td class="memTemplParams" colspan="2">template&lt;typename Cache &gt; </td></tr>
<tr class="memitem:a42b2f5314bd1f7813f545f634d82943e"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a42b2f5314bd1f7813f545f634d82943e">test_cache_erase_parallel</a> (size_t megabytes)</td></tr>
<tr class="separator:a42b2f5314bd1f7813f545f634d82943e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb4b3b8995590e36ee1eda24ad1ec95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a2fb4b3b8995590e36ee1eda24ad1ec95">BOOST_AUTO_TEST_CASE</a> (cuckoocache_erase_parallel_ok)</td></tr>
<tr class="separator:a2fb4b3b8995590e36ee1eda24ad1ec95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf31adbea16e03190635af313bf74946"><td class="memTemplParams" colspan="2">template&lt;typename Cache &gt; </td></tr>
<tr class="memitem:abf31adbea16e03190635af313bf74946"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#abf31adbea16e03190635af313bf74946">test_cache_generations</a> ()</td></tr>
<tr class="separator:abf31adbea16e03190635af313bf74946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e0ac08c51c7a1865dee84af8f0f383"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#a82e0ac08c51c7a1865dee84af8f0f383">BOOST_AUTO_TEST_CASE</a> (cuckoocache_generations)</td></tr>
<tr class="separator:a82e0ac08c51c7a1865dee84af8f0f383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f71af5c6c124222dd1c42c5df892f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuckoocache__tests_8cpp.html#af7f71af5c6c124222dd1c42c5df892f4">BOOST_AUTO_TEST_SUITE_END</a> ()</td></tr>
<tr class="separator:af7f71af5c6c124222dd1c42c5df892f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a66cf33a4becc3c40557ef3ebbc4049fe" name="a66cf33a4becc3c40557ef3ebbc4049fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66cf33a4becc3c40557ef3ebbc4049fe">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">cuckoocache_erase_ok&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00180">180</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>

</div>
</div>
<a id="a2fb4b3b8995590e36ee1eda24ad1ec95" name="a2fb4b3b8995590e36ee1eda24ad1ec95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fb4b3b8995590e36ee1eda24ad1ec95">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">cuckoocache_erase_parallel_ok&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00269">269</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>

</div>
</div>
<a id="a82e0ac08c51c7a1865dee84af8f0f383" name="a82e0ac08c51c7a1865dee84af8f0f383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e0ac08c51c7a1865dee84af8f0f383">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">cuckoocache_generations&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00366">366</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>

</div>
</div>
<a id="a299febd68f12d139909825335e09a57b" name="a299febd68f12d139909825335e09a57b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299febd68f12d139909825335e09a57b">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">cuckoocache_hit_rate_ok&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the hit rate on loads ranging from 0.1 to 1.6. </p>
<p >Arbitrarily selected Hit Rate threshold that happens to work for this test as a lower bound on performance.</p>

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00107">107</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_a299febd68f12d139909825335e09a57b_cgraph.svg" width="394" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a214df47c3c8fef6d59339193f9db46f0" name="a214df47c3c8fef6d59339193f9db46f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a214df47c3c8fef6d59339193f9db46f0">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">test_cuckoocache_no_fakes&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00036">36</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_a214df47c3c8fef6d59339193f9db46f0_cgraph.svg" width="2412" height="884"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acff99631b1b544d01990adb377ce74a8" name="acff99631b1b544d01990adb377ce74a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acff99631b1b544d01990adb377ce74a8">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_SUITE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_SUITE </td>
          <td>(</td>
          <td class="paramtype">cuckoocache_tests&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test Suite for <a class="el" href="namespace_cuckoo_cache.html" title="High-performance cache primitives.">CuckooCache</a>. </p>
<ol type="1">
<li>All tests should have a deterministic result (using insecure rand with deterministic seeds)</li>
<li>Some test methods are templated to allow for easier testing against new versions / comparing</li>
<li>Results should be treated as a regression test, i.e., did the behavior change significantly from what was expected. This can be OK, depending on the nature of the change, but requires updating the tests to reflect the new expected behavior. For example improving the hit rate may cause some tests using BOOST_CHECK_CLOSE to fail. </li>
</ol>

</div>
</div>
<a id="af7f71af5c6c124222dd1c42c5df892f4" name="af7f71af5c6c124222dd1c42c5df892f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f71af5c6c124222dd1c42c5df892f4">&#9670;&nbsp;</a></span>BOOST_AUTO_TEST_SUITE_END()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_SUITE_END </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa589a224768fce4e01558f10d7dca8e" name="afa589a224768fce4e01558f10d7dca8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa589a224768fce4e01558f10d7dca8e">&#9670;&nbsp;</a></span>normalize_hit_rate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double normalize_hit_rate </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>load</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The normalized hit rate for a given load. </p>
<p >The semantics are a little confusing, so please see the below explanation.</p>
<p >Examples:</p>
<ol type="1">
<li>at load 0.5, we expect a perfect hit rate, so we multiply by 1.0</li>
<li>at load 2.0, we expect to see half the entries, so a perfect hit rate would be 0.5. Therefore, if we see a hit rate of 0.4, 0.4*2.0 = 0.8 is the normalized hit rate.</li>
</ol>
<p >This is basically the right semantics, but has a bit of a glitch depending on how you measure around load 1.0 as after load 1.0 your normalized hit rate becomes effectively perfect, ignoring freshness. </p>

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00101">101</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_afa589a224768fce4e01558f10d7dca8e_icgraph.svg" width="394" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af8d08afa024b8416f8df44deb63527b6" name="af8d08afa024b8416f8df44deb63527b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8d08afa024b8416f8df44deb63527b6">&#9670;&nbsp;</a></span>test_cache()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Cache &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double test_cache </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>megabytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>load</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This helper returns the hit rate when megabytes*load worth of entries are inserted into a megabytes sized cache. </p>
<p >We make a copy of the hashes because future optimizations of the cuckoocache may overwrite the inserted element, so the test is "future proofed".</p>
<p >Do the insert</p>
<p >Count the hits</p>

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00054">54</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_af8d08afa024b8416f8df44deb63527b6_cgraph.svg" width="2334" height="822"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a65d579e17ce4017d37251f85640cb9e3" name="a65d579e17ce4017d37251f85640cb9e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d579e17ce4017d37251f85640cb9e3">&#9670;&nbsp;</a></span>test_cache_erase()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Cache &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_cache_erase </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>megabytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This helper checks that erased elements are preferentially inserted onto and that the hit rate of "fresher" keys is reasonable. </p>
<p >We make a copy of the hashes because future optimizations of the cuckoocache may overwrite the inserted element, so the test is "future proofed".</p>
<p >Insert the first half</p>
<p >Erase the first quarter</p>
<p >Insert the second half</p>
<p >elements that we marked as erased but are still there</p>
<p >elements that we did not erase but are older</p>
<p >elements that were most recently inserted</p>

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00124">124</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_a65d579e17ce4017d37251f85640cb9e3_cgraph.svg" width="2376" height="822"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a42b2f5314bd1f7813f545f634d82943e" name="a42b2f5314bd1f7813f545f634d82943e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42b2f5314bd1f7813f545f634d82943e">&#9670;&nbsp;</a></span>test_cache_erase_parallel()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Cache &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_cache_erase_parallel </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>megabytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >We make a copy of the hashes because future optimizations of the cuckoocache may overwrite the inserted element, so the test is "future proofed".</p>
<p >Grab lock to make sure we release inserts</p>
<p >Insert the first half</p>
<p >Spin up 3 threads to run contains with erase.</p>
<p >Erase the first quarter</p>
<p >Each thread is emplaced with x copy-by-value</p>
<p >Wait for all threads to finish</p>
<p >Grab lock to make sure we observe erases</p>
<p >Insert the second half</p>
<p >elements that we marked erased but that are still there</p>
<p >elements that we did not erase but are older</p>
<p >elements that were most recently inserted</p>

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00187">187</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_a42b2f5314bd1f7813f545f634d82943e_cgraph.svg" width="2432" height="683"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abf31adbea16e03190635af313bf74946" name="abf31adbea16e03190635af313bf74946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf31adbea16e03190635af313bf74946">&#9670;&nbsp;</a></span>test_cache_generations()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Cache &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_cache_generations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cuckoocache__tests_8cpp_source.html#l00277">277</a> of file <a class="el" href="cuckoocache__tests_8cpp_source.html">cuckoocache_tests.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cuckoocache__tests_8cpp_abf31adbea16e03190635af313bf74946_cgraph.svg" width="2418" height="822"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 8 2021 14:20:09 for Bitcoin Core by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
