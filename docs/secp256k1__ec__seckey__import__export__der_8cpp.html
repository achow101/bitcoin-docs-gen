<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bitcoin Core: src/test/fuzz/secp256k1_ec_seckey_import_export_der.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bitcoin_logo_doxygen.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bitcoin Core<span id="projectnumber">&#160;22.99.0</span>
   </div>
   <div id="projectbrief">P2P Digital Currency</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_120ed4da3e3217b1e7fc0b4f48568e79.html">test</a></li><li class="navelem"><a class="el" href="dir_138f41adef4ef461a11339c4e97f91d6.html">fuzz</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">secp256k1_ec_seckey_import_export_der.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="key_8h_source.html">key.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="secp256k1_8h_source.html">secp256k1.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_fuzzed_data_provider_8h_source.html">test/fuzz/FuzzedDataProvider.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="fuzz_8h_source.html">test/fuzz/fuzz.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="test_2fuzz_2util_8h_source.html">test/fuzz/util.h</a>&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for secp256k1_ec_seckey_import_export_der.cpp:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="secp256k1__ec__seckey__import__export__der_8cpp__incl.svg" width="3751" height="679"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="secp256k1__ec__seckey__import__export__der_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acb3e61a21bab4d7e4f38985463982b73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="secp256k1__ec__seckey__import__export__der_8cpp.html#acb3e61a21bab4d7e4f38985463982b73">ec_seckey_import_der</a> (const <a class="el" href="pubkey_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, unsigned char *out32, const unsigned char *seckey, size_t seckeylen)</td></tr>
<tr class="memdesc:acb3e61a21bab4d7e4f38985463982b73"><td class="mdescLeft">&#160;</td><td class="mdescRight">These functions are taken from the libsecp256k1 distribution and are very ugly.  <a href="secp256k1__ec__seckey__import__export__der_8cpp.html#acb3e61a21bab4d7e4f38985463982b73">More...</a><br /></td></tr>
<tr class="separator:acb3e61a21bab4d7e4f38985463982b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dfc834bbe7d6fb7715c07826c1b1507"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="secp256k1__ec__seckey__import__export__der_8cpp.html#a8dfc834bbe7d6fb7715c07826c1b1507">ec_seckey_export_der</a> (const <a class="el" href="pubkey_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, unsigned char *seckey, size_t *seckeylen, const unsigned char *key32, bool compressed)</td></tr>
<tr class="memdesc:a8dfc834bbe7d6fb7715c07826c1b1507"><td class="mdescLeft">&#160;</td><td class="mdescRight">This serializes to a DER encoding of the ECPrivateKey type from section C.4 of SEC 1 <a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>.  <a href="secp256k1__ec__seckey__import__export__der_8cpp.html#a8dfc834bbe7d6fb7715c07826c1b1507">More...</a><br /></td></tr>
<tr class="separator:a8dfc834bbe7d6fb7715c07826c1b1507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cdc982d6d3eaf89b21961fd5d96471e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="secp256k1__ec__seckey__import__export__der_8cpp.html#a2cdc982d6d3eaf89b21961fd5d96471e">FUZZ_TARGET</a> (secp256k1_ec_seckey_import_export_der)</td></tr>
<tr class="separator:a2cdc982d6d3eaf89b21961fd5d96471e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8dfc834bbe7d6fb7715c07826c1b1507" name="a8dfc834bbe7d6fb7715c07826c1b1507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dfc834bbe7d6fb7715c07826c1b1507">&#9670;&nbsp;</a></span>ec_seckey_export_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ec_seckey_export_der </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="pubkey_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>seckeylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compressed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This serializes to a DER encoding of the ECPrivateKey type from section C.4 of SEC 1 <a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>. </p>
<p >The optional parameters and publicKey fields are included.</p>
<p >seckey must point to an output buffer of length at least <a class="el" href="class_c_key.html#a169ecb59546896c545f12c3c7a1ec757" title="secp256k1:">CKey::SIZE</a> bytes. seckeylen must initially be set to the size of the seckey buffer. Upon return it will be set to the number of bytes used in the buffer. key32 must point to a 32-byte raw private key. </p>

<p class="definition">Definition at line <a class="el" href="key_8cpp_source.html#l00094">94</a> of file <a class="el" href="key_8cpp_source.html">key.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="secp256k1__ec__seckey__import__export__der_8cpp_a8dfc834bbe7d6fb7715c07826c1b1507_cgraph.svg" width="892" height="611"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="secp256k1__ec__seckey__import__export__der_8cpp_a8dfc834bbe7d6fb7715c07826c1b1507_icgraph.svg" width="2350" height="314"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acb3e61a21bab4d7e4f38985463982b73" name="acb3e61a21bab4d7e4f38985463982b73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb3e61a21bab4d7e4f38985463982b73">&#9670;&nbsp;</a></span>ec_seckey_import_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ec_seckey_import_der </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="pubkey_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>seckeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>These functions are taken from the libsecp256k1 distribution and are very ugly. </p>
<p >This parses a format loosely based on a DER encoding of the ECPrivateKey type from section C.4 of SEC 1 <a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>, with the following caveats:</p>
<ul>
<li>The octet-length of the SEQUENCE must be encoded as 1 or 2 octets. It is not required to be encoded as one octet if it is less than 256, as DER would require.</li>
<li>The octet-length of the SEQUENCE must not be greater than the remaining length of the key encoding, but need not match it (i.e. the encoding may contain junk after the encoded SEQUENCE).</li>
<li>The privateKey OCTET STRING is zero-filled on the left to 32 octets.</li>
<li>Anything after the encoding of the privateKey OCTET STRING is ignored, whether or not it is validly encoded DER.</li>
</ul>
<p >out32 must point to an output buffer of length at least 32 bytes. </p>

<p class="definition">Definition at line <a class="el" href="key_8cpp_source.html#l00037">37</a> of file <a class="el" href="key_8cpp_source.html">key.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="secp256k1__ec__seckey__import__export__der_8cpp_acb3e61a21bab4d7e4f38985463982b73_cgraph.svg" width="618" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="secp256k1__ec__seckey__import__export__der_8cpp_acb3e61a21bab4d7e4f38985463982b73_icgraph.svg" width="1207" height="172"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2cdc982d6d3eaf89b21961fd5d96471e" name="a2cdc982d6d3eaf89b21961fd5d96471e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cdc982d6d3eaf89b21961fd5d96471e">&#9670;&nbsp;</a></span>FUZZ_TARGET()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FUZZ_TARGET </td>
          <td>(</td>
          <td class="paramtype">secp256k1_ec_seckey_import_export_der&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="secp256k1__ec__seckey__import__export__der_8cpp_source.html#l00017">17</a> of file <a class="el" href="secp256k1__ec__seckey__import__export__der_8cpp_source.html">secp256k1_ec_seckey_import_export_der.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="secp256k1__ec__seckey__import__export__der_8cpp_a2cdc982d6d3eaf89b21961fd5d96471e_cgraph.svg" width="1526" height="1292"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 8 2021 14:20:09 for Bitcoin Core by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
