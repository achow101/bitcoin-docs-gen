<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bitcoin Core: TaprootBuilder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bitcoin_logo_doxygen.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bitcoin Core<span id="projectnumber">&#160;22.99.0</span>
   </div>
   <div id="projectbrief">P2P Digital Currency</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_taproot_builder-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TaprootBuilder Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Utility class to construct Taproot outputs from internal key and script tree.  
 <a href="class_taproot_builder.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="standard_8h_source.html">standard.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for TaprootBuilder:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder__coll__graph.svg" width="188" height="310"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_taproot_builder_1_1_leaf_info.html">LeafInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about a tracked leaf in the Merkle tree.  <a href="struct_taproot_builder_1_1_leaf_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information associated with a node in the Merkle tree.  <a href="struct_taproot_builder_1_1_node_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a20f484320cb56a6ea3405c3976603fcb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_taproot_builder.html">TaprootBuilder</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a20f484320cb56a6ea3405c3976603fcb">Add</a> (int depth, const <a class="el" href="class_c_script.html">CScript</a> &amp;script, int leaf_version, bool track=true)</td></tr>
<tr class="memdesc:a20f484320cb56a6ea3405c3976603fcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new script at a certain depth in the tree.  <a href="class_taproot_builder.html#a20f484320cb56a6ea3405c3976603fcb">More...</a><br /></td></tr>
<tr class="separator:a20f484320cb56a6ea3405c3976603fcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e8f57369077b1a02887b36a91323b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_taproot_builder.html">TaprootBuilder</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#ac8e8f57369077b1a02887b36a91323b6">AddOmitted</a> (int depth, const <a class="el" href="classuint256.html">uint256</a> &amp;hash)</td></tr>
<tr class="memdesc:ac8e8f57369077b1a02887b36a91323b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Like <a class="el" href="class_taproot_builder.html#a20f484320cb56a6ea3405c3976603fcb" title="Add a new script at a certain depth in the tree.">Add()</a>, but for a Merkle node with a given hash to the tree.  <a href="class_taproot_builder.html#ac8e8f57369077b1a02887b36a91323b6">More...</a><br /></td></tr>
<tr class="separator:ac8e8f57369077b1a02887b36a91323b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67a316d15a068578db70df4a65a0ae5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_taproot_builder.html">TaprootBuilder</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#ad67a316d15a068578db70df4a65a0ae5">Finalize</a> (const <a class="el" href="class_x_only_pub_key.html">XOnlyPubKey</a> &amp;internal_key)</td></tr>
<tr class="memdesc:ad67a316d15a068578db70df4a65a0ae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalize the construction.  <a href="class_taproot_builder.html#ad67a316d15a068578db70df4a65a0ae5">More...</a><br /></td></tr>
<tr class="separator:ad67a316d15a068578db70df4a65a0ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794cd5235ce97dabbc628da223ffbf23"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a794cd5235ce97dabbc628da223ffbf23">IsValid</a> () const</td></tr>
<tr class="memdesc:a794cd5235ce97dabbc628da223ffbf23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if so far all input was valid.  <a href="class_taproot_builder.html#a794cd5235ce97dabbc628da223ffbf23">More...</a><br /></td></tr>
<tr class="separator:a794cd5235ce97dabbc628da223ffbf23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7277f1000ce0e211ef3f2e7e78c482"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a2f7277f1000ce0e211ef3f2e7e78c482">IsComplete</a> () const</td></tr>
<tr class="memdesc:a2f7277f1000ce0e211ef3f2e7e78c482"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether there were either no leaves, or the leaves form a Huffman tree.  <a href="class_taproot_builder.html#a2f7277f1000ce0e211ef3f2e7e78c482">More...</a><br /></td></tr>
<tr class="separator:a2f7277f1000ce0e211ef3f2e7e78c482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012c94c5033ad9276f5842f8e7883726"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_witness_v1_taproot.html">WitnessV1Taproot</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a012c94c5033ad9276f5842f8e7883726">GetOutput</a> ()</td></tr>
<tr class="memdesc:a012c94c5033ad9276f5842f8e7883726"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute scriptPubKey (after <a class="el" href="class_taproot_builder.html#ad67a316d15a068578db70df4a65a0ae5" title="Finalize the construction.">Finalize()</a>).  <a href="class_taproot_builder.html#a012c94c5033ad9276f5842f8e7883726">More...</a><br /></td></tr>
<tr class="separator:a012c94c5033ad9276f5842f8e7883726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a124ce4e973bfe7aa06e1ccd185b9f540"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_taproot_spend_data.html">TaprootSpendData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a124ce4e973bfe7aa06e1ccd185b9f540">GetSpendData</a> () const</td></tr>
<tr class="memdesc:a124ce4e973bfe7aa06e1ccd185b9f540"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute spending data (after <a class="el" href="class_taproot_builder.html#ad67a316d15a068578db70df4a65a0ae5" title="Finalize the construction.">Finalize()</a>).  <a href="class_taproot_builder.html#a124ce4e973bfe7aa06e1ccd185b9f540">More...</a><br /></td></tr>
<tr class="separator:a124ce4e973bfe7aa06e1ccd185b9f540"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a40d0666436abe411d126dbcfdec62bb9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a40d0666436abe411d126dbcfdec62bb9">ValidDepths</a> (const std::vector&lt; int &gt; &amp;depths)</td></tr>
<tr class="memdesc:a40d0666436abe411d126dbcfdec62bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a list of depths is legal (will lead to <a class="el" href="class_taproot_builder.html#a2f7277f1000ce0e211ef3f2e7e78c482" title="Return whether there were either no leaves, or the leaves form a Huffman tree.">IsComplete()</a>).  <a href="class_taproot_builder.html#a40d0666436abe411d126dbcfdec62bb9">More...</a><br /></td></tr>
<tr class="separator:a40d0666436abe411d126dbcfdec62bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5b844d6152996c8ef5ac676b9f6e4aac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a5b844d6152996c8ef5ac676b9f6e4aac">Insert</a> (<a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a> &amp;&amp;node, int depth)</td></tr>
<tr class="memdesc:a5b844d6152996c8ef5ac676b9f6e4aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert information about a node at a certain depth, and propagate information up.  <a href="class_taproot_builder.html#a5b844d6152996c8ef5ac676b9f6e4aac">More...</a><br /></td></tr>
<tr class="separator:a5b844d6152996c8ef5ac676b9f6e4aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a024d8f06dce96910fb78a95262c4bc99"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a024d8f06dce96910fb78a95262c4bc99">Combine</a> (<a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a> &amp;&amp;a, <a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a> &amp;&amp;b)</td></tr>
<tr class="memdesc:a024d8f06dce96910fb78a95262c4bc99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine information about a parent Merkle tree node from its child nodes.  <a href="class_taproot_builder.html#a024d8f06dce96910fb78a95262c4bc99">More...</a><br /></td></tr>
<tr class="separator:a024d8f06dce96910fb78a95262c4bc99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afcfa97bf914fb497b9066e81c3aff6ca"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#afcfa97bf914fb497b9066e81c3aff6ca">m_valid</a> = true</td></tr>
<tr class="memdesc:afcfa97bf914fb497b9066e81c3aff6ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the builder is in a valid state so far.  <a href="class_taproot_builder.html#afcfa97bf914fb497b9066e81c3aff6ca">More...</a><br /></td></tr>
<tr class="separator:afcfa97bf914fb497b9066e81c3aff6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac071a0224054cbd307f7832f4eb9cfaf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::optional&lt; <a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#ac071a0224054cbd307f7832f4eb9cfaf">m_branch</a></td></tr>
<tr class="memdesc:ac071a0224054cbd307f7832f4eb9cfaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current state of the builder.  <a href="class_taproot_builder.html#ac071a0224054cbd307f7832f4eb9cfaf">More...</a><br /></td></tr>
<tr class="separator:ac071a0224054cbd307f7832f4eb9cfaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e8f11895ae8346e921baa40442bddb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_x_only_pub_key.html">XOnlyPubKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a75e8f11895ae8346e921baa40442bddb">m_internal_key</a></td></tr>
<tr class="memdesc:a75e8f11895ae8346e921baa40442bddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The internal key, set when finalizing.  <a href="class_taproot_builder.html#a75e8f11895ae8346e921baa40442bddb">More...</a><br /></td></tr>
<tr class="separator:a75e8f11895ae8346e921baa40442bddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783dc33c7ac2919cbb439b8d56d79a15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_x_only_pub_key.html">XOnlyPubKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#a783dc33c7ac2919cbb439b8d56d79a15">m_output_key</a></td></tr>
<tr class="memdesc:a783dc33c7ac2919cbb439b8d56d79a15"><td class="mdescLeft">&#160;</td><td class="mdescRight">The output key, computed when finalizing.  <a href="class_taproot_builder.html#a783dc33c7ac2919cbb439b8d56d79a15">More...</a><br /></td></tr>
<tr class="separator:a783dc33c7ac2919cbb439b8d56d79a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae983c8469e9e49a49da1a6370072d5bd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_taproot_builder.html#ae983c8469e9e49a49da1a6370072d5bd">m_parity</a></td></tr>
<tr class="memdesc:ae983c8469e9e49a49da1a6370072d5bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The tweak parity, computed when finalizing.  <a href="class_taproot_builder.html#ae983c8469e9e49a49da1a6370072d5bd">More...</a><br /></td></tr>
<tr class="separator:ae983c8469e9e49a49da1a6370072d5bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Utility class to construct Taproot outputs from internal key and script tree. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00225">225</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a20f484320cb56a6ea3405c3976603fcb" name="a20f484320cb56a6ea3405c3976603fcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f484320cb56a6ea3405c3976603fcb">&#9670;&nbsp;</a></span>Add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_taproot_builder.html">TaprootBuilder</a> &amp; TaprootBuilder::Add </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_c_script.html">CScript</a> &amp;&#160;</td>
          <td class="paramname"><em>script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>leaf_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>track</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new script at a certain depth in the tree. </p>
<p ><a class="el" href="class_taproot_builder.html#a20f484320cb56a6ea3405c3976603fcb" title="Add a new script at a certain depth in the tree.">Add()</a> operations must be called in depth-first traversal order of binary tree. If track is true, it will be included in the <a class="el" href="class_taproot_builder.html#a124ce4e973bfe7aa06e1ccd185b9f540" title="Compute spending data (after Finalize()).">GetSpendData()</a> output. </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00428">428</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a20f484320cb56a6ea3405c3976603fcb_cgraph.svg" width="606" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a20f484320cb56a6ea3405c3976603fcb_icgraph.svg" width="399" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac8e8f57369077b1a02887b36a91323b6" name="ac8e8f57369077b1a02887b36a91323b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e8f57369077b1a02887b36a91323b6">&#9670;&nbsp;</a></span>AddOmitted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_taproot_builder.html">TaprootBuilder</a> &amp; TaprootBuilder::AddOmitted </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classuint256.html">uint256</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Like <a class="el" href="class_taproot_builder.html#a20f484320cb56a6ea3405c3976603fcb" title="Add a new script at a certain depth in the tree.">Add()</a>, but for a Merkle node with a given hash to the tree. </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00441">441</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_ac8e8f57369077b1a02887b36a91323b6_cgraph.svg" width="659" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_ac8e8f57369077b1a02887b36a91323b6_icgraph.svg" width="452" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a024d8f06dce96910fb78a95262c4bc99" name="a024d8f06dce96910fb78a95262c4bc99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a024d8f06dce96910fb78a95262c4bc99">&#9670;&nbsp;</a></span>Combine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_taproot_builder_1_1_node_info.html">TaprootBuilder::NodeInfo</a> TaprootBuilder::Combine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Combine information about a parent Merkle tree node from its child nodes. </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00336">336</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a024d8f06dce96910fb78a95262c4bc99_icgraph.svg" width="892" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad67a316d15a068578db70df4a65a0ae5" name="ad67a316d15a068578db70df4a65a0ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad67a316d15a068578db70df4a65a0ae5">&#9670;&nbsp;</a></span>Finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_taproot_builder.html">TaprootBuilder</a> &amp; TaprootBuilder::Finalize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_x_only_pub_key.html">XOnlyPubKey</a> &amp;&#160;</td>
          <td class="paramname"><em>internal_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalize the construction. </p>
<p >Can only be called when <a class="el" href="class_taproot_builder.html#a2f7277f1000ce0e211ef3f2e7e78c482" title="Return whether there were either no leaves, or the leaves form a Huffman tree.">IsComplete()</a> is true. internal_key.IsFullyValid() must be true. </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00451">451</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_ad67a316d15a068578db70df4a65a0ae5_cgraph.svg" width="1552" height="707"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_ad67a316d15a068578db70df4a65a0ae5_icgraph.svg" width="424" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a012c94c5033ad9276f5842f8e7883726" name="a012c94c5033ad9276f5842f8e7883726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012c94c5033ad9276f5842f8e7883726">&#9670;&nbsp;</a></span>GetOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_witness_v1_taproot.html">WitnessV1Taproot</a> TaprootBuilder::GetOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute scriptPubKey (after <a class="el" href="class_taproot_builder.html#ad67a316d15a068578db70df4a65a0ae5" title="Finalize the construction.">Finalize()</a>). </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00462">462</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a012c94c5033ad9276f5842f8e7883726_icgraph.svg" width="440" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a124ce4e973bfe7aa06e1ccd185b9f540" name="a124ce4e973bfe7aa06e1ccd185b9f540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a124ce4e973bfe7aa06e1ccd185b9f540">&#9670;&nbsp;</a></span>GetSpendData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_taproot_spend_data.html">TaprootSpendData</a> TaprootBuilder::GetSpendData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute spending data (after <a class="el" href="class_taproot_builder.html#ad67a316d15a068578db70df4a65a0ae5" title="Finalize the construction.">Finalize()</a>). </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00464">464</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a124ce4e973bfe7aa06e1ccd185b9f540_cgraph.svg" width="656" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5b844d6152996c8ef5ac676b9f6e4aac" name="a5b844d6152996c8ef5ac676b9f6e4aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b844d6152996c8ef5ac676b9f6e4aac">&#9670;&nbsp;</a></span>Insert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TaprootBuilder::Insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_taproot_builder_1_1_node_info.html">TaprootBuilder::NodeInfo</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Insert information about a node at a certain depth, and propagate information up. </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00379">379</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a5b844d6152996c8ef5ac676b9f6e4aac_cgraph.svg" width="403" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a5b844d6152996c8ef5ac676b9f6e4aac_icgraph.svg" width="662" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2f7277f1000ce0e211ef3f2e7e78c482" name="a2f7277f1000ce0e211ef3f2e7e78c482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f7277f1000ce0e211ef3f2e7e78c482">&#9670;&nbsp;</a></span>IsComplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TaprootBuilder::IsComplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return whether there were either no leaves, or the leaves form a Huffman tree. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00308">308</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a2f7277f1000ce0e211ef3f2e7e78c482_icgraph.svg" width="715" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a794cd5235ce97dabbc628da223ffbf23" name="a794cd5235ce97dabbc628da223ffbf23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794cd5235ce97dabbc628da223ffbf23">&#9670;&nbsp;</a></span>IsValid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TaprootBuilder::IsValid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return true if so far all input was valid. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00306">306</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a794cd5235ce97dabbc628da223ffbf23_icgraph.svg" width="667" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a40d0666436abe411d126dbcfdec62bb9" name="a40d0666436abe411d126dbcfdec62bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d0666436abe411d126dbcfdec62bb9">&#9670;&nbsp;</a></span>ValidDepths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TaprootBuilder::ValidDepths </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>depths</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if a list of depths is legal (will lead to <a class="el" href="class_taproot_builder.html#a2f7277f1000ce0e211ef3f2e7e78c482" title="Return whether there were either no leaves, or the leaves form a Huffman tree.">IsComplete()</a>). </p>

<p class="definition">Definition at line <a class="el" href="standard_8cpp_source.html#l00405">405</a> of file <a class="el" href="standard_8cpp_source.html">standard.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a40d0666436abe411d126dbcfdec62bb9_cgraph.svg" width="324" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_taproot_builder_a40d0666436abe411d126dbcfdec62bb9_icgraph.svg" width="452" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac071a0224054cbd307f7832f4eb9cfaf" name="ac071a0224054cbd307f7832f4eb9cfaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac071a0224054cbd307f7832f4eb9cfaf">&#9670;&nbsp;</a></span>m_branch</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::optional&lt;<a class="el" href="struct_taproot_builder_1_1_node_info.html">NodeInfo</a>&gt; &gt; TaprootBuilder::m_branch</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The current state of the builder. </p>
<p >For each level in the tree, one <a class="el" href="struct_taproot_builder_1_1_node_info.html" title="Information associated with a node in the Merkle tree.">NodeInfo</a> object may be present. m_branch[0] is information about the root; further values are for deeper subtrees being explored.</p>
<p >For every right branch taken to reach the position we're currently working in, there will be a (non-nullopt) entry in m_branch corresponding to the left branch at that level.</p>
<p >For example, imagine this tree: - N0 - / \ N1 N2 / \ / \ A B C N3 / \ D E</p>
<p >Initially, m_branch is empty. After processing leaf A, it would become {nullopt, nullopt, A}. When processing leaf B, an entry at level 2 already exists, and it would thus be combined with it to produce a level 1 one, resulting in {nullopt, N1}. Adding C and D takes us to {nullopt, N1, C} and {nullopt, N1, C, D} respectively. When E is processed, it is combined with D, and then C, and then N1, to produce the root, resulting in {N0}.</p>
<p >This structure allows processing with just O(log n) overhead if the leaves are computed on the fly.</p>
<p >As an invariant, there can never be nullopt entries at the end. There can also not be more than 128 entries (as that would mean more than 128 levels in the tree). The depth of newly added entries will always be at least equal to the current size of m_branch (otherwise it does not correspond to a depth-first traversal of a tree). m_branch is only empty if no entries have ever be processed. m_branch having length 1 corresponds to being done. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00283">283</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>

</div>
</div>
<a id="a75e8f11895ae8346e921baa40442bddb" name="a75e8f11895ae8346e921baa40442bddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e8f11895ae8346e921baa40442bddb">&#9670;&nbsp;</a></span>m_internal_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_x_only_pub_key.html">XOnlyPubKey</a> TaprootBuilder::m_internal_key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The internal key, set when finalizing. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00285">285</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>

</div>
</div>
<a id="a783dc33c7ac2919cbb439b8d56d79a15" name="a783dc33c7ac2919cbb439b8d56d79a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a783dc33c7ac2919cbb439b8d56d79a15">&#9670;&nbsp;</a></span>m_output_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_x_only_pub_key.html">XOnlyPubKey</a> TaprootBuilder::m_output_key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The output key, computed when finalizing. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00286">286</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>

</div>
</div>
<a id="ae983c8469e9e49a49da1a6370072d5bd" name="ae983c8469e9e49a49da1a6370072d5bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae983c8469e9e49a49da1a6370072d5bd">&#9670;&nbsp;</a></span>m_parity</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TaprootBuilder::m_parity</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The tweak parity, computed when finalizing. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00287">287</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>

</div>
</div>
<a id="afcfa97bf914fb497b9066e81c3aff6ca" name="afcfa97bf914fb497b9066e81c3aff6ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcfa97bf914fb497b9066e81c3aff6ca">&#9670;&nbsp;</a></span>m_valid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TaprootBuilder::m_valid = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the builder is in a valid state so far. </p>

<p class="definition">Definition at line <a class="el" href="standard_8h_source.html#l00246">246</a> of file <a class="el" href="standard_8h_source.html">standard.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/script/<a class="el" href="standard_8h_source.html">standard.h</a></li>
<li>src/script/<a class="el" href="standard_8cpp_source.html">standard.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 8 2021 14:20:12 for Bitcoin Core by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
